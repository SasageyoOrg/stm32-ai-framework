Neural Network Tools for STM32AI v1.6.0 (STM.ai v7.1.0-RC3)
Created date          : 2022-08-03 17:12:26
Parameters            : generate --name network -m /Users/edoardo/STM32CubeIDE/workspace_1.10.1/stm32f4-ai-framework/Models/foodreco/FoodReco_MobileNet_Derivative_Float.h5 --type keras --compression 1 --verbosity 1 --workspace /var/folders/48/l0spqxpd4fb53zl2tk8w7hq00000gn/T/mxAI_workspace8055952156664742892787367309511 --output /Users/edoardo/.stm32cubemx/network_output

Exec/report summary (generate)
------------------------------------------------------------------------------------------------------------------------
model file            : /Users/edoardo/STM32CubeIDE/workspace_1.10.1/stm32f4-ai-framework/Models/foodreco/FoodReco_MobileNet_Derivative_Float.h5
type                  : keras
c_name                : network
compression           : None
allocator strategy    : ['multi-heaps']
target info           : /private/var/folders/48/l0spqxpd4fb53zl2tk8w7hq00000gn/T/mxAI_workspace8055952156664742892787367309511/mempools.json
workspace dir         : /private/var/folders/48/l0spqxpd4fb53zl2tk8w7hq00000gn/T/mxAI_workspace8055952156664742892787367309511
output dir            : /Users/edoardo/.stm32cubemx/network_output
model_name            : FoodReco_MobileNet_Derivative_Float
model_hash            : 699704694b08d8ce0dea81c49f22f53a
input 1/1             : 'input_2'
                        150528 items, 588.00 KiB, ai_float, float, (1,224,224,3), domain:user/
output 1/1            : 'conv_preds_conv2d'
                        18 items, 72 B, ai_float, float, (1,1,1,18), domain:user/
params #              : 129,930 items (507.54 KiB)
macc                  : 12,071,056
weights (ro)          : 515,272 B (503.20 KiB) / -4,448(-0.9%) vs original model (1 segment)
activations (rw)      : 403,232 B (393.78 KiB) (1 segment)
ram (total)           : 1,005,416 B (981.85 KiB) = 403,232 + 602,112 + 72

Memory-pools summary (activations/ domain)
------------------------------------------------------
name   id   usable size   used                buffer#
------------------------------------------------------
pool   0    4.00 MiB      393.78 KiB (9.6%)   24     
------------------------------------------------------

Model name - FoodReco_MobileNet_Derivative_Float ['input_2'] ['reshape_2']
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
id   layer (type)                        oshape             param/size       macc        connected to                 |   c_size            c_macc              c_type                
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
0    input_2 (Input)                     (None,224,224,3)                                                             |                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1    conv1_conv2d (Conv2D)               (None,112,112,8)   216/864          2,709,504   input_2                      |   +32(+3.7%)        +100,360(+3.7%)     conv2d()[0]           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2    conv1_bn (ScaleBias)                (None,112,112,8)   16/64            200,704     conv1_conv2d                 |   -64(-100.0%)      -200,704(-100.0%)  
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
3    conv1_relu (Nonlinearity)           (None,112,112,8)                    100,352     conv1_bn                     |                     -100,352(-100.0%)  
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
4    conv_dw_1_conv2d (Conv2D)           (None,56,56,8)     80/320           225,800     conv1_relu                   |                                         conv2d()[1]           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
5    conv_pw_1_conv2d (Conv2D)           (None,56,56,16)    128/512          401,408     conv_dw_1_conv2d             |   +64(+12.5%)       +50,192(+12.5%)     conv2d()[2]           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
6    conv_pw_1_bn (ScaleBias)            (None,56,56,16)    32/128           100,352     conv_pw_1_conv2d             |   -128(-100.0%)     -100,352(-100.0%)  
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
7    conv_pw_1_relu (Nonlinearity)       (None,56,56,16)                     50,176      conv_pw_1_bn                 |                     -50,176(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
8    conv_dw_2_conv2d (Conv2D)           (None,28,28,16)    160/640          112,912     conv_pw_1_relu               |                                         conv2d()[3]           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
9    conv_pw_2_conv2d (Conv2D)           (None,28,28,32)    512/2,048        401,408     conv_dw_2_conv2d             |   +128(+6.2%)       +25,120(+6.3%)      conv2d()[4]           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
10   conv_pw_2_bn (ScaleBias)            (None,28,28,32)    64/256           50,176      conv_pw_2_conv2d             |   -256(-100.0%)     -50,176(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
11   conv_pw_2_relu (Nonlinearity)       (None,28,28,32)                     25,088      conv_pw_2_bn                 |                     -25,088(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
12   conv_dw_3_conv2d (Conv2D)           (None,28,28,32)    320/1,280        225,824     conv_pw_2_relu               |                                         conv2d()[5]           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
13   conv_pw_3_conv2d (Conv2D)           (None,28,28,32)    1,024/4,096      802,816     conv_dw_3_conv2d             |   +128(+3.1%)       +25,120(+3.1%)      conv2d()[6]           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
14   conv_pw_3_bn (ScaleBias)            (None,28,28,32)    64/256           50,176      conv_pw_3_conv2d             |   -256(-100.0%)     -50,176(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
15   conv_pw_3_relu (Nonlinearity)       (None,28,28,32)                     25,088      conv_pw_3_bn                 |                     -25,088(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
16   conv_dw_4_conv2d (Conv2D)           (None,14,14,32)    320/1,280        56,480      conv_pw_3_relu               |                                         conv2d()[7]           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
17   conv_pw_4_conv2d (Conv2D)           (None,14,14,64)    2,048/8,192      401,408     conv_dw_4_conv2d             |   +256(+3.1%)       +12,608(+3.1%)      conv2d()[8]           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
18   conv_pw_4_bn (ScaleBias)            (None,14,14,64)    128/512          25,088      conv_pw_4_conv2d             |   -512(-100.0%)     -25,088(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
19   conv_pw_4_relu (Nonlinearity)       (None,14,14,64)                     12,544      conv_pw_4_bn                 |                     -12,544(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
20   conv_dw_5_conv2d (Conv2D)           (None,14,14,64)    640/2,560        112,960     conv_pw_4_relu               |                                         conv2d()[9]           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
21   conv_pw_5_conv2d (Conv2D)           (None,14,14,64)    4,096/16,384     802,816     conv_dw_5_conv2d             |   +256(+1.6%)       +12,608(+1.6%)      conv2d()[10]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
22   conv_pw_5_bn (ScaleBias)            (None,14,14,64)    128/512          25,088      conv_pw_5_conv2d             |   -512(-100.0%)     -25,088(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
23   conv_pw_5_relu (Nonlinearity)       (None,14,14,64)                     12,544      conv_pw_5_bn                 |                     -12,544(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
24   conv_dw_6_conv2d (Conv2D)           (None,7,7,64)      640/2,560        28,288      conv_pw_5_relu               |                                         conv2d()[11]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
25   conv_pw_6_conv2d (Conv2D)           (None,7,7,128)     8,192/32,768     401,408     conv_dw_6_conv2d             |   +512(+1.6%)       +6,400(+1.6%)       conv2d()[12]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
26   conv_pw_6_bn (ScaleBias)            (None,7,7,128)     256/1,024        12,544      conv_pw_6_conv2d             |   -1,024(-100.0%)   -12,544(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
27   conv_pw_6_relu (Nonlinearity)       (None,7,7,128)                      6,272       conv_pw_6_bn                 |                     -6,272(-100.0%)    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
28   conv_dw_7_conv2d (Conv2D)           (None,7,7,128)     1,280/5,120      56,576      conv_pw_6_relu               |                                         conv2d()[13]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
29   conv_pw_7_conv2d (Conv2D)           (None,7,7,128)     16,384/65,536    802,816     conv_dw_7_conv2d             |   +512(+0.8%)       +6,400(+0.8%)       conv2d()[14]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
30   conv_pw_7_bn (ScaleBias)            (None,7,7,128)     256/1,024        12,544      conv_pw_7_conv2d             |   -1,024(-100.0%)   -12,544(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
31   conv_pw_7_relu (Nonlinearity)       (None,7,7,128)                      6,272       conv_pw_7_bn                 |                     -6,272(-100.0%)    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
32   conv_dw_8_conv2d (Conv2D)           (None,7,7,128)     1,280/5,120      56,576      conv_pw_7_relu               |                                         conv2d()[15]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
33   conv_pw_8_conv2d (Conv2D)           (None,7,7,128)     16,384/65,536    802,816     conv_dw_8_conv2d             |   +512(+0.8%)       +6,400(+0.8%)       conv2d()[16]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
34   conv_pw_8_bn (ScaleBias)            (None,7,7,128)     256/1,024        12,544      conv_pw_8_conv2d             |   -1,024(-100.0%)   -12,544(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
35   conv_pw_8_relu (Nonlinearity)       (None,7,7,128)                      6,272       conv_pw_8_bn                 |                     -6,272(-100.0%)    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
36   conv_dw_9_conv2d (Conv2D)           (None,7,7,128)     1,280/5,120      56,576      conv_pw_8_relu               |                                         conv2d()[17]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
37   conv_pw_9_conv2d (Conv2D)           (None,7,7,128)     16,384/65,536    802,816     conv_dw_9_conv2d             |   +512(+0.8%)       +6,400(+0.8%)       conv2d()[18]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
38   conv_pw_9_bn (ScaleBias)            (None,7,7,128)     256/1,024        12,544      conv_pw_9_conv2d             |   -1,024(-100.0%)   -12,544(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
39   conv_pw_9_relu (Nonlinearity)       (None,7,7,128)                      6,272       conv_pw_9_bn                 |                     -6,272(-100.0%)    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
40   conv_dw_10_conv2d (Conv2D)          (None,7,7,128)     1,280/5,120      56,576      conv_pw_9_relu               |                                         conv2d()[19]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
41   conv_pw_10_conv2d (Conv2D)          (None,7,7,128)     16,384/65,536    802,816     conv_dw_10_conv2d            |   +512(+0.8%)       +6,400(+0.8%)       conv2d()[20]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
42   conv_pw_10_bn (ScaleBias)           (None,7,7,128)     256/1,024        12,544      conv_pw_10_conv2d            |   -1,024(-100.0%)   -12,544(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
43   conv_pw_10_relu (Nonlinearity)      (None,7,7,128)                      6,272       conv_pw_10_bn                |                     -6,272(-100.0%)    
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
44   conv_dw_11_conv2d (Conv2D)          (None,7,7,128)     1,280/5,120      56,576      conv_pw_10_relu              |                                         conv2d()[21]          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
45   conv_pw_11_conv2d (Conv2D)          (None,7,7,256)     32,768/131,072   1,605,632   conv_dw_11_conv2d            |   +1,024(+0.8%)     +25,344(+1.6%)      optimized_conv2d()[22]
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
46   conv_pw_11_bn (ScaleBias)           (None,7,7,256)     512/2,048        25,088      conv_pw_11_conv2d            |   -2,048(-100.0%)   -25,088(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
47   conv_pw_11_relu (Nonlinearity)      (None,7,7,256)                      12,544      conv_pw_11_bn                |                     -12,544(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
48   global_average_pooling2d_2 (Pool)   (None,1,1,256)                      12,544      conv_pw_11_relu              |                     -12,544(-100.0%)   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
49   reshape_1 (Reshape)                 (1,1,1,256)                                     global_average_pooling2d_2   |                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
51   conv_preds_conv2d (Conv2D)          (1,1,1,18)         4,626/18,504     4,626       reshape_1                    |                     +270(+5.8%)         conv2d()/o[23]        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
52   act_softmax (Nonlinearity)          (1,1,1,18)                          270         conv_preds_conv2d            |                     -270(-100.0%)      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
53   reshape_2 (Reshape)                 (1,1,1,18)                                      act_softmax                  |                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
model/c-model: macc=12,609,336/12,071,056 -538,280(-4.3%) weights=519,720/515,272 -4,448(-0.9%) activations=--/403,232 io=--/602,184



Generated C-graph summary
------------------------------------------------------------------------------------------------------------------------
model name            : foodreco_mobilenet_derivative_float
c-name                : network
c-node #              : 24
c-array #             : 74
activations size      : 403232 (1 segments)
weights size          : 515272 (1 segments)
macc                  : 12071056
inputs                : ['input_2_output']
outputs               : ['conv_preds_conv2d_output']

C-Arrays (74)
-----------------------------------------------------------------------------------------------------
c_id   name (*_array)               item/size       domain/mem-pool    c-type        fmt     comment
-----------------------------------------------------------------------------------------------------
0      input_2_output               150528/602112   user/              float         float   /input 
1      conv1_conv2d_output          100352/401408   activations/pool   float         float          
2      conv_dw_1_conv2d_output      25088/100352    activations/pool   float         float          
3      conv_pw_1_conv2d_output      50176/200704    activations/pool   float         float          
4      conv_dw_2_conv2d_output      12544/50176     activations/pool   float         float          
5      conv_pw_2_conv2d_output      25088/100352    activations/pool   float         float          
6      conv_dw_3_conv2d_output      25088/100352    activations/pool   float         float          
7      conv_pw_3_conv2d_output      25088/100352    activations/pool   float         float          
8      conv_dw_4_conv2d_output      6272/25088      activations/pool   float         float          
9      conv_pw_4_conv2d_output      12544/50176     activations/pool   float         float          
10     conv_dw_5_conv2d_output      12544/50176     activations/pool   float         float          
11     conv_pw_5_conv2d_output      12544/50176     activations/pool   float         float          
12     conv_dw_6_conv2d_output      3136/12544      activations/pool   float         float          
13     conv_pw_6_conv2d_output      6272/25088      activations/pool   float         float          
14     conv_dw_7_conv2d_output      6272/25088      activations/pool   float         float          
15     conv_pw_7_conv2d_output      6272/25088      activations/pool   float         float          
16     conv_dw_8_conv2d_output      6272/25088      activations/pool   float         float          
17     conv_pw_8_conv2d_output      6272/25088      activations/pool   float         float          
18     conv_dw_9_conv2d_output      6272/25088      activations/pool   float         float          
19     conv_pw_9_conv2d_output      6272/25088      activations/pool   float         float          
20     conv_dw_10_conv2d_output     6272/25088      activations/pool   float         float          
21     conv_pw_10_conv2d_output     6272/25088      activations/pool   float         float          
22     conv_dw_11_conv2d_output     6272/25088      activations/pool   float         float          
23     conv_pw_11_conv2d_output     256/1024        activations/pool   float         float          
24     conv_preds_conv2d_output     18/72           user/              float         float   /output
25     conv1_conv2d_weights         216/864         weights/           const float   float          
26     conv1_conv2d_bias            8/32            weights/           const float   float          
27     conv_dw_1_conv2d_weights     72/288          weights/           const float   float          
28     conv_dw_1_conv2d_bias        8/32            weights/           const float   float          
29     conv_pw_1_conv2d_weights     128/512         weights/           const float   float          
30     conv_pw_1_conv2d_bias        16/64           weights/           const float   float          
31     conv_dw_2_conv2d_weights     144/576         weights/           const float   float          
32     conv_dw_2_conv2d_bias        16/64           weights/           const float   float          
33     conv_pw_2_conv2d_weights     512/2048        weights/           const float   float          
34     conv_pw_2_conv2d_bias        32/128          weights/           const float   float          
35     conv_dw_3_conv2d_weights     288/1152        weights/           const float   float          
36     conv_dw_3_conv2d_bias        32/128          weights/           const float   float          
37     conv_pw_3_conv2d_weights     1024/4096       weights/           const float   float          
38     conv_pw_3_conv2d_bias        32/128          weights/           const float   float          
39     conv_dw_4_conv2d_weights     288/1152        weights/           const float   float          
40     conv_dw_4_conv2d_bias        32/128          weights/           const float   float          
41     conv_pw_4_conv2d_weights     2048/8192       weights/           const float   float          
42     conv_pw_4_conv2d_bias        64/256          weights/           const float   float          
43     conv_dw_5_conv2d_weights     576/2304        weights/           const float   float          
44     conv_dw_5_conv2d_bias        64/256          weights/           const float   float          
45     conv_pw_5_conv2d_weights     4096/16384      weights/           const float   float          
46     conv_pw_5_conv2d_bias        64/256          weights/           const float   float          
47     conv_dw_6_conv2d_weights     576/2304        weights/           const float   float          
48     conv_dw_6_conv2d_bias        64/256          weights/           const float   float          
49     conv_pw_6_conv2d_weights     8192/32768      weights/           const float   float          
50     conv_pw_6_conv2d_bias        128/512         weights/           const float   float          
51     conv_dw_7_conv2d_weights     1152/4608       weights/           const float   float          
52     conv_dw_7_conv2d_bias        128/512         weights/           const float   float          
53     conv_pw_7_conv2d_weights     16384/65536     weights/           const float   float          
54     conv_pw_7_conv2d_bias        128/512         weights/           const float   float          
55     conv_dw_8_conv2d_weights     1152/4608       weights/           const float   float          
56     conv_dw_8_conv2d_bias        128/512         weights/           const float   float          
57     conv_pw_8_conv2d_weights     16384/65536     weights/           const float   float          
58     conv_pw_8_conv2d_bias        128/512         weights/           const float   float          
59     conv_dw_9_conv2d_weights     1152/4608       weights/           const float   float          
60     conv_dw_9_conv2d_bias        128/512         weights/           const float   float          
61     conv_pw_9_conv2d_weights     16384/65536     weights/           const float   float          
62     conv_pw_9_conv2d_bias        128/512         weights/           const float   float          
63     conv_dw_10_conv2d_weights    1152/4608       weights/           const float   float          
64     conv_dw_10_conv2d_bias       128/512         weights/           const float   float          
65     conv_pw_10_conv2d_weights    16384/65536     weights/           const float   float          
66     conv_pw_10_conv2d_bias       128/512         weights/           const float   float          
67     conv_dw_11_conv2d_weights    1152/4608       weights/           const float   float          
68     conv_dw_11_conv2d_bias       128/512         weights/           const float   float          
69     conv_pw_11_conv2d_weights    32768/131072    weights/           const float   float          
70     conv_pw_11_conv2d_bias       256/1024        weights/           const float   float          
71     conv_preds_conv2d_weights    4608/18432      weights/           const float   float          
72     conv_preds_conv2d_bias       18/72           weights/           const float   float          
73     conv_pw_11_conv2d_scratch0   12544/50176     activations/pool   float         float          
-----------------------------------------------------------------------------------------------------

C-Layers (24)
-------------------------------------------------------------------------------------------------------------------------
c_id   name (*_layer)      id   layer_type         macc      rom      tensors                         shape (array id)  
-------------------------------------------------------------------------------------------------------------------------
0      conv1_conv2d        3    conv2d             2809864   896      I: input_2_output               (1,224,224,3) (0) 
                                                                      W: conv1_conv2d_weights         (3,8,3,3) (25)    
                                                                      W: conv1_conv2d_bias            (1,1,1,8) (26)    
                                                                      O: conv1_conv2d_output          (1,112,112,8) (1) 
-------------------------------------------------------------------------------------------------------------------------
1      conv_dw_1_conv2d    4    conv2d             225800    320      I: conv1_conv2d_output          (1,112,112,8) (1) 
                                                                      W: conv_dw_1_conv2d_weights     (1,8,3,3) (27)    
                                                                      W: conv_dw_1_conv2d_bias        (1,1,1,8) (28)    
                                                                      O: conv_dw_1_conv2d_output      (1,56,56,8) (2)   
-------------------------------------------------------------------------------------------------------------------------
2      conv_pw_1_conv2d    7    conv2d             451600    576      I: conv_dw_1_conv2d_output      (1,56,56,8) (2)   
                                                                      W: conv_pw_1_conv2d_weights     (8,16,1,1) (29)   
                                                                      W: conv_pw_1_conv2d_bias        (1,1,1,16) (30)   
                                                                      O: conv_pw_1_conv2d_output      (1,56,56,16) (3)  
-------------------------------------------------------------------------------------------------------------------------
3      conv_dw_2_conv2d    8    conv2d             112912    640      I: conv_pw_1_conv2d_output      (1,56,56,16) (3)  
                                                                      W: conv_dw_2_conv2d_weights     (1,16,3,3) (31)   
                                                                      W: conv_dw_2_conv2d_bias        (1,1,1,16) (32)   
                                                                      O: conv_dw_2_conv2d_output      (1,28,28,16) (4)  
-------------------------------------------------------------------------------------------------------------------------
4      conv_pw_2_conv2d    11   conv2d             426528    2176     I: conv_dw_2_conv2d_output      (1,28,28,16) (4)  
                                                                      W: conv_pw_2_conv2d_weights     (16,32,1,1) (33)  
                                                                      W: conv_pw_2_conv2d_bias        (1,1,1,32) (34)   
                                                                      O: conv_pw_2_conv2d_output      (1,28,28,32) (5)  
-------------------------------------------------------------------------------------------------------------------------
5      conv_dw_3_conv2d    12   conv2d             225824    1280     I: conv_pw_2_conv2d_output      (1,28,28,32) (5)  
                                                                      W: conv_dw_3_conv2d_weights     (1,32,3,3) (35)   
                                                                      W: conv_dw_3_conv2d_bias        (1,1,1,32) (36)   
                                                                      O: conv_dw_3_conv2d_output      (1,28,28,32) (6)  
-------------------------------------------------------------------------------------------------------------------------
6      conv_pw_3_conv2d    15   conv2d             827936    4224     I: conv_dw_3_conv2d_output      (1,28,28,32) (6)  
                                                                      W: conv_pw_3_conv2d_weights     (32,32,1,1) (37)  
                                                                      W: conv_pw_3_conv2d_bias        (1,1,1,32) (38)   
                                                                      O: conv_pw_3_conv2d_output      (1,28,28,32) (7)  
-------------------------------------------------------------------------------------------------------------------------
7      conv_dw_4_conv2d    16   conv2d             56480     1280     I: conv_pw_3_conv2d_output      (1,28,28,32) (7)  
                                                                      W: conv_dw_4_conv2d_weights     (1,32,3,3) (39)   
                                                                      W: conv_dw_4_conv2d_bias        (1,1,1,32) (40)   
                                                                      O: conv_dw_4_conv2d_output      (1,14,14,32) (8)  
-------------------------------------------------------------------------------------------------------------------------
8      conv_pw_4_conv2d    19   conv2d             414016    8448     I: conv_dw_4_conv2d_output      (1,14,14,32) (8)  
                                                                      W: conv_pw_4_conv2d_weights     (32,64,1,1) (41)  
                                                                      W: conv_pw_4_conv2d_bias        (1,1,1,64) (42)   
                                                                      O: conv_pw_4_conv2d_output      (1,14,14,64) (9)  
-------------------------------------------------------------------------------------------------------------------------
9      conv_dw_5_conv2d    20   conv2d             112960    2560     I: conv_pw_4_conv2d_output      (1,14,14,64) (9)  
                                                                      W: conv_dw_5_conv2d_weights     (1,64,3,3) (43)   
                                                                      W: conv_dw_5_conv2d_bias        (1,1,1,64) (44)   
                                                                      O: conv_dw_5_conv2d_output      (1,14,14,64) (10) 
-------------------------------------------------------------------------------------------------------------------------
10     conv_pw_5_conv2d    23   conv2d             815424    16640    I: conv_dw_5_conv2d_output      (1,14,14,64) (10) 
                                                                      W: conv_pw_5_conv2d_weights     (64,64,1,1) (45)  
                                                                      W: conv_pw_5_conv2d_bias        (1,1,1,64) (46)   
                                                                      O: conv_pw_5_conv2d_output      (1,14,14,64) (11) 
-------------------------------------------------------------------------------------------------------------------------
11     conv_dw_6_conv2d    24   conv2d             28288     2560     I: conv_pw_5_conv2d_output      (1,14,14,64) (11) 
                                                                      W: conv_dw_6_conv2d_weights     (1,64,3,3) (47)   
                                                                      W: conv_dw_6_conv2d_bias        (1,1,1,64) (48)   
                                                                      O: conv_dw_6_conv2d_output      (1,7,7,64) (12)   
-------------------------------------------------------------------------------------------------------------------------
12     conv_pw_6_conv2d    27   conv2d             407808    33280    I: conv_dw_6_conv2d_output      (1,7,7,64) (12)   
                                                                      W: conv_pw_6_conv2d_weights     (64,128,1,1) (49) 
                                                                      W: conv_pw_6_conv2d_bias        (1,1,1,128) (50)  
                                                                      O: conv_pw_6_conv2d_output      (1,7,7,128) (13)  
-------------------------------------------------------------------------------------------------------------------------
13     conv_dw_7_conv2d    28   conv2d             56576     5120     I: conv_pw_6_conv2d_output      (1,7,7,128) (13)  
                                                                      W: conv_dw_7_conv2d_weights     (1,128,3,3) (51)  
                                                                      W: conv_dw_7_conv2d_bias        (1,1,1,128) (52)  
                                                                      O: conv_dw_7_conv2d_output      (1,7,7,128) (14)  
-------------------------------------------------------------------------------------------------------------------------
14     conv_pw_7_conv2d    31   conv2d             809216    66048    I: conv_dw_7_conv2d_output      (1,7,7,128) (14)  
                                                                      W: conv_pw_7_conv2d_weights     (128,128,1,1) (53)
                                                                      W: conv_pw_7_conv2d_bias        (1,1,1,128) (54)  
                                                                      O: conv_pw_7_conv2d_output      (1,7,7,128) (15)  
-------------------------------------------------------------------------------------------------------------------------
15     conv_dw_8_conv2d    32   conv2d             56576     5120     I: conv_pw_7_conv2d_output      (1,7,7,128) (15)  
                                                                      W: conv_dw_8_conv2d_weights     (1,128,3,3) (55)  
                                                                      W: conv_dw_8_conv2d_bias        (1,1,1,128) (56)  
                                                                      O: conv_dw_8_conv2d_output      (1,7,7,128) (16)  
-------------------------------------------------------------------------------------------------------------------------
16     conv_pw_8_conv2d    35   conv2d             809216    66048    I: conv_dw_8_conv2d_output      (1,7,7,128) (16)  
                                                                      W: conv_pw_8_conv2d_weights     (128,128,1,1) (57)
                                                                      W: conv_pw_8_conv2d_bias        (1,1,1,128) (58)  
                                                                      O: conv_pw_8_conv2d_output      (1,7,7,128) (17)  
-------------------------------------------------------------------------------------------------------------------------
17     conv_dw_9_conv2d    36   conv2d             56576     5120     I: conv_pw_8_conv2d_output      (1,7,7,128) (17)  
                                                                      W: conv_dw_9_conv2d_weights     (1,128,3,3) (59)  
                                                                      W: conv_dw_9_conv2d_bias        (1,1,1,128) (60)  
                                                                      O: conv_dw_9_conv2d_output      (1,7,7,128) (18)  
-------------------------------------------------------------------------------------------------------------------------
18     conv_pw_9_conv2d    39   conv2d             809216    66048    I: conv_dw_9_conv2d_output      (1,7,7,128) (18)  
                                                                      W: conv_pw_9_conv2d_weights     (128,128,1,1) (61)
                                                                      W: conv_pw_9_conv2d_bias        (1,1,1,128) (62)  
                                                                      O: conv_pw_9_conv2d_output      (1,7,7,128) (19)  
-------------------------------------------------------------------------------------------------------------------------
19     conv_dw_10_conv2d   40   conv2d             56576     5120     I: conv_pw_9_conv2d_output      (1,7,7,128) (19)  
                                                                      W: conv_dw_10_conv2d_weights    (1,128,3,3) (63)  
                                                                      W: conv_dw_10_conv2d_bias       (1,1,1,128) (64)  
                                                                      O: conv_dw_10_conv2d_output     (1,7,7,128) (20)  
-------------------------------------------------------------------------------------------------------------------------
20     conv_pw_10_conv2d   43   conv2d             809216    66048    I: conv_dw_10_conv2d_output     (1,7,7,128) (20)  
                                                                      W: conv_pw_10_conv2d_weights    (128,128,1,1) (65)
                                                                      W: conv_pw_10_conv2d_bias       (1,1,1,128) (66)  
                                                                      O: conv_pw_10_conv2d_output     (1,7,7,128) (21)  
-------------------------------------------------------------------------------------------------------------------------
21     conv_dw_11_conv2d   44   conv2d             56576     5120     I: conv_pw_10_conv2d_output     (1,7,7,128) (21)  
                                                                      W: conv_dw_11_conv2d_weights    (1,128,3,3) (67)  
                                                                      W: conv_dw_11_conv2d_bias       (1,1,1,128) (68)  
                                                                      O: conv_dw_11_conv2d_output     (1,7,7,128) (22)  
-------------------------------------------------------------------------------------------------------------------------
22     conv_pw_11_conv2d   48   optimized_conv2d   1630976   132096   I: conv_dw_11_conv2d_output     (1,7,7,128) (22)  
                                                                      S: conv_pw_11_conv2d_scratch0                     
                                                                      W: conv_pw_11_conv2d_weights    (128,256,1,1) (69)
                                                                      W: conv_pw_11_conv2d_bias       (1,1,1,256) (70)  
                                                                      O: conv_pw_11_conv2d_output     (1,1,1,256) (23)  
-------------------------------------------------------------------------------------------------------------------------
23     conv_preds_conv2d   52   conv2d             4896      18504    I: conv_pw_11_conv2d_output     (1,1,1,256) (23)  
                                                                      W: conv_preds_conv2d_weights    (256,18,1,1) (71) 
                                                                      W: conv_preds_conv2d_bias       (1,1,1,18) (72)   
                                                                      O: conv_preds_conv2d_output     (1,1,1,18) (24)   
-------------------------------------------------------------------------------------------------------------------------



Complexity report per layer - macc=12,071,056 weights=515,272 act=403,232 ram_io=602,184
----------------------------------------------------------------------------------
id   name                c_macc                    c_rom                     c_id
----------------------------------------------------------------------------------
1    conv1_conv2d        ||||||||||||||||  23.3%   |                  0.2%   [0] 
4    conv_dw_1_conv2d    ||                 1.9%   |                  0.1%   [1] 
5    conv_pw_1_conv2d    |||                3.7%   |                  0.1%   [2] 
8    conv_dw_2_conv2d    |                  0.9%   |                  0.1%   [3] 
9    conv_pw_2_conv2d    |||                3.5%   |                  0.4%   [4] 
12   conv_dw_3_conv2d    ||                 1.9%   |                  0.2%   [5] 
13   conv_pw_3_conv2d    |||||              6.9%   |                  0.8%   [6] 
16   conv_dw_4_conv2d    |                  0.5%   |                  0.2%   [7] 
17   conv_pw_4_conv2d    |||                3.4%   |                  1.6%   [8] 
20   conv_dw_5_conv2d    |                  0.9%   |                  0.5%   [9] 
21   conv_pw_5_conv2d    |||||              6.8%   ||                 3.2%   [10]
24   conv_dw_6_conv2d    |                  0.2%   |                  0.5%   [11]
25   conv_pw_6_conv2d    |||                3.4%   ||||               6.5%   [12]
28   conv_dw_7_conv2d    |                  0.5%   |                  1.0%   [13]
29   conv_pw_7_conv2d    |||||              6.7%   ||||||||          12.8%   [14]
32   conv_dw_8_conv2d    |                  0.5%   |                  1.0%   [15]
33   conv_pw_8_conv2d    |||||              6.7%   ||||||||          12.8%   [16]
36   conv_dw_9_conv2d    |                  0.5%   |                  1.0%   [17]
37   conv_pw_9_conv2d    |||||              6.7%   ||||||||          12.8%   [18]
40   conv_dw_10_conv2d   |                  0.5%   |                  1.0%   [19]
41   conv_pw_10_conv2d   |||||              6.7%   ||||||||          12.8%   [20]
44   conv_dw_11_conv2d   |                  0.5%   |                  1.0%   [21]
45   conv_pw_11_conv2d   |||||||||         13.5%   ||||||||||||||||  25.6%   [22]
51   conv_preds_conv2d   |                  0.0%   |||                3.6%   [23]

Generated files (5)
---------------------------------------------------------------------
/Users/edoardo/.stm32cubemx/network_output/network_config.h
/Users/edoardo/.stm32cubemx/network_output/network.h
/Users/edoardo/.stm32cubemx/network_output/network.c
/Users/edoardo/.stm32cubemx/network_output/network_data.h
/Users/edoardo/.stm32cubemx/network_output/network_data.c
